<% content_for :title, "Student Profile" %>

<% full_name = @student.full_name.presence || @student.user&.name || "Student" %>
<% email = @student.email %>
<% uin = @student.uin.presence || "Not provided" %>
<% track = @student.track.present? ? @student.track.to_s.titleize : "Not assigned" %>
<% major = @student.major.presence || "Program TBD" %>
<% advisor_name = @student.advisor&.name || "Advisor pending" %>
<% member_since = @student.created_at ? @student.created_at.strftime("%b %-d, %Y") : "Recently" %>
<% updated_text = @student.updated_at ? time_ago_in_words(@student.updated_at) + " ago" : "Just now" %>
<% initials = full_name.split.first(2).map { |part| part.first&.upcase }.join.presence || "ST" %>

<main class="student-profile-page px-4 py-10">
  <div class="student-profile-container mx-auto max-w-6xl space-y-10">
    <section class="student-profile-hero">
      <div class="student-profile-hero__content">
        <div>
          <p class="student-profile-hero__eyebrow">Your student profile</p>
          <h1 class="student-profile-hero__title"><%= full_name %></h1>
          <p class="student-profile-hero__subtitle">Track your program status, advisor, and key milestones.</p>
          <div class="student-profile-hero__badges">
            <span class="hero-badge">
              <span class="hero-badge__dot"></span>
              Track Â· <%= track %>
            </span>
            <span class="hero-badge">
              Cohort member since <%= member_since %>
            </span>
            <span class="hero-badge">
              Updated <%= updated_text %>
            </span>
          </div>
        </div>
        <div class="student-profile-hero__meta">
          <div>
            <p class="meta-label">Primary email</p>
            <p class="meta-value"><%= email %></p>
            <p class="meta-label">Advisor</p>
            <p class="meta-value"><%= advisor_name %></p>
          </div>
          <div class="student-profile-hero__avatar">
            <span><%= initials %></span>
          </div>
        </div>
      </div>
      <div class="student-profile-hero__stats">
        <article>
          <p class="stat-label">Major / Program</p>
          <p class="stat-value"><%= major %></p>
        </article>
        <article>
          <p class="stat-label">UIN</p>
          <p class="stat-value"><%= uin %></p>
        </article>
        <article>
          <p class="stat-label">Advisor status</p>
          <p class="stat-value"><%= advisor_name %></p>
        </article>
      </div>
    </section>

    <div class="student-profile-grid">
      <section class="student-card student-card--personal">
        <header>
          <p class="eyebrow">Personal details</p>
          <h2>Student identity</h2>
        </header>
        <dl>
          <div>
            <dt>Full name</dt>
            <dd><%= full_name %></dd>
          </div>
          <div>
            <dt>Email</dt>
            <dd><%= email %></dd>
          </div>
          <div>
            <dt>UIN</dt>
            <dd><%= uin %></dd>
          </div>
        </dl>
      </section>

      <section class="student-card student-card--academic">
        <header>
          <p class="eyebrow">Academic journey</p>
          <h2>Program snapshot</h2>
        </header>
        <dl>
          <div>
            <dt>Major / Program</dt>
            <dd><%= major %></dd>
          </div>
          <div>
            <dt>Program track</dt>
            <dd><%= track %></dd>
          </div>
          <div>
            <dt>Advisor</dt>
            <dd><%= advisor_name %></dd>
          </div>
        </dl>
      </section>

      <section class="student-card student-card--timeline">
        <header>
          <p class="eyebrow">Timeline</p>
          <h2>Key milestones</h2>
        </header>
        <ul>
          <li>
            <span class="timeline-dot"></span>
            <div>
              <p>Profile created</p>
              <small><%= @student.created_at&.strftime("%B %d, %Y") || "Awaiting" %></small>
            </div>
          </li>
          <li>
            <span class="timeline-dot"></span>
            <div>
              <p>Last updated</p>
              <small><%= @student.updated_at&.strftime("%B %d, %Y") || "Recently" %></small>
            </div>
          </li>
          <li>
            <span class="timeline-dot timeline-dot--ghost"></span>
            <div>
              <p>Next survey assignment</p>
              <small>Assigned automatically after advisor review</small>
            </div>
          </li>
        </ul>
      </section>

      <section class="student-card student-card--support">
        <header>
          <p class="eyebrow">Need adjustments?</p>
          <h2>Keep your profile current</h2>
        </header>
        <p>Update your profile when you change tracks, switch advisors, or need to refresh your contact information. Accurate info keeps survey assignments on track.</p>
        <div class="support-actions">
          <%= link_to edit_student_profile_path, class: tailwind_button_classes(:primary) do %>
            Edit profile
          <% end %>
          <%= link_to student_dashboard_path, class: tailwind_button_classes(:secondary) do %>
            Back to dashboard
          <% end %>
        </div>
      </section>
    </div>
  </div>
</main>
