<main class="main-content space-y-12">
  <header class="c-toolbar c-toolbar--spaced">
    <div class="c-toolbar__row justify-between w-full items-end">
              <%= link_to "← Back",
                    admin_dashboard_path,
                    class: tailwind_button_classes(:secondary),
                    data: { turbo: false } %>
      
    </div>

    <div class="flex flex-wrap items-center justify-end gap-3">
                                    <div class="space-y-2">
        <h1 class="text-3xl font-semibold tracking-tight text-slate-900">Program Setup</h1>
        <p class="text-sm text-slate-600">Manage program tracks, majors, years, and semesters.</p>
      </div>
      </div>

  </header>



  <nav class="flex flex-wrap gap-2" aria-label="Program setup tabs">
    <% tabs = [
      ["Tracks", "tracks"],
      ["Majors", "majors"],
      ["Years", "years"],
      ["Semesters", "semesters"]
    ] %>

    <% tabs.each do |label, value| %>
      <% active = (@tab == value) %>
      <%= link_to label,
                  admin_program_setup_path(tab: value),
                  class: active ? tailwind_button_classes(:primary, extra_classes: "btn-sm") : tailwind_button_classes(:secondary, extra_classes: "btn-sm") %>
    <% end %>
  </nav>

  <% if @tab == "tracks" %>
    <section class="w-full c-card u-stack">
      <header class="toolbar">
        <div>
          <h2 class="text-xl font-semibold text-slate-900">Tracks</h2>
          <p class="text-sm text-slate-600">View and manage the track options available across the app.</p>
        </div>
      </header>

      <div class="grid gap-6 lg:grid-cols-[2fr_1fr]">
        <div class="u-stack u-stack--md">
          <% if @program_tracks.blank? %>
            <div class="rounded-xl border border-dashed border-slate-300 bg-slate-50 px-4 py-6 text-sm text-slate-600">
              No tracks yet. Use the form to create your first entry.
            </div>
          <% else %>
            <ul class="space-y-3">
              <% @program_tracks.each do |track| %>
                <li class="rounded-xl border border-slate-200 bg-slate-50 px-4 py-3">
                  <div class="flex flex-wrap items-center justify-between gap-3">
                    <div>
                      <p class="text-base font-semibold text-slate-900"><%= track.name %></p>
                      <p class="text-xs text-slate-500">Key: <%= track.key %> · Position: <%= track.position %></p>
                    </div>
                    <div class="flex flex-wrap items-center gap-2">
                      <% if track.active? %>
                        <span class="inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700">Active</span>
                      <% else %>
                        <span class="inline-flex items-center rounded-full bg-slate-200 px-3 py-1 text-xs font-semibold text-slate-700">Inactive</span>
                      <% end %>
                      <details class="group">
                        <summary class="cursor-pointer list-none <%= tailwind_button_classes(:secondary, extra_classes: 'btn-sm') %>">Edit</summary>
                        <div class="mt-3 rounded-lg border border-slate-200 bg-white p-4">
                          <%= form_with model: [:admin, track], local: true, class: "space-y-3" do |form| %>
                            <div class="grid gap-3 sm:grid-cols-2">
                              <div class="space-y-1">
                                <%= form.label :name, "Name", class: "text-sm font-medium text-slate-700" %>
                                <%= form.text_field :name, required: true, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm" %>
                              </div>
                              <div class="space-y-1">
                                <%= form.label :key, "Key", class: "text-sm font-medium text-slate-700" %>
                                <%= form.text_field :key, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm" %>
                              </div>
                              <div class="space-y-1">
                                <%= form.label :position, "Position", class: "text-sm font-medium text-slate-700" %>
                                <%= form.number_field :position, min: 0, step: 1, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm" %>
                              </div>
                              <div class="flex items-center gap-2 pt-6 text-sm text-slate-700">
                                <%= form.check_box :active, class: "h-4 w-4 rounded border-slate-300" %>
                                <%= form.label :active, "Active", class: "text-sm font-medium text-slate-700" %>
                              </div>
                            </div>
                            <div class="flex flex-wrap gap-2">
                              <%= form.submit "Save changes", class: tailwind_button_classes(:primary, extra_classes: "btn-sm") %>
                              <%= button_to "Delete",
                                            admin_program_track_path(track),
                                            method: :delete,
                                            data: { turbo_confirm: "Delete #{track.name}?" },
                                            class: tailwind_button_classes(:danger, extra_classes: "btn-sm") %>
                            </div>
                          <% end %>
                        </div>
                      </details>
                    </div>
                  </div>
                </li>
              <% end %>
            </ul>
          <% end %>
        </div>

        <div class="c-card c-card--tight c-card--muted">
          <h3 class="text-base font-semibold text-slate-900">Add track</h3>
          <p class="mb-4 text-sm text-slate-600">Name tracks consistently (e.g., "Residential").</p>
          <%= form_with model: [:admin, @new_program_track], url: admin_program_tracks_path, local: true, class: "space-y-4" do |form| %>
            <div class="space-y-1">
              <%= form.label :name, "Track name", class: "text-sm font-medium text-slate-700" %>
              <%= form.text_field :name, required: true, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm shadow-sm", placeholder: "Residential" %>
            </div>
            <%= form.submit "Save track", class: tailwind_button_classes(:primary) %>
          <% end %>
        </div>
      </div>
    </section>
  <% end %>

  <% if @tab == "majors" %>
    <section class="w-full c-card u-stack">
      <header class="toolbar">
        <div>
          <h2 class="text-xl font-semibold text-slate-900">Majors</h2>
          <p class="text-sm text-slate-600">View and manage majors available for student profiles.</p>
        </div>
      </header>

      <div class="grid gap-6 lg:grid-cols-[2fr_1fr]">
        <div class="u-stack u-stack--md">
          <% if @majors.blank? %>
            <div class="rounded-xl border border-dashed border-slate-300 bg-slate-50 px-4 py-6 text-sm text-slate-600">
              No majors yet. Use the form to create your first entry.
            </div>
          <% else %>
            <ul class="space-y-3">
              <% @majors.each do |major| %>
                <li class="rounded-xl border border-slate-200 bg-slate-50 px-4 py-3">
                  <div class="flex flex-wrap items-center justify-between gap-3">
                    <div>
                      <p class="text-base font-semibold text-slate-900"><%= major.name %></p>
                    </div>
                    <div class="flex flex-wrap items-center gap-2">
                      <details>
                        <summary class="cursor-pointer list-none <%= tailwind_button_classes(:secondary, extra_classes: 'btn-sm') %>">Edit</summary>
                        <div class="mt-3 rounded-lg border border-slate-200 bg-white p-4">
                          <%= form_with model: [:admin, major], local: true, class: "space-y-3" do |form| %>
                            <div class="space-y-1">
                              <%= form.label :name, "Name", class: "text-sm font-medium text-slate-700" %>
                              <%= form.text_field :name, required: true, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm" %>
                            </div>
                            <div class="flex flex-wrap gap-2">
                              <%= form.submit "Save changes", class: tailwind_button_classes(:primary, extra_classes: "btn-sm") %>
                              <%= button_to "Delete",
                                            admin_major_path(major),
                                            method: :delete,
                                            data: { turbo_confirm: "Delete #{major.name}?" },
                                            class: tailwind_button_classes(:danger, extra_classes: "btn-sm") %>
                            </div>
                          <% end %>
                        </div>
                      </details>
                    </div>
                  </div>
                </li>
              <% end %>
            </ul>
          <% end %>
        </div>

        <div class="c-card c-card--tight c-card--muted">
          <h3 class="text-base font-semibold text-slate-900">Add major</h3>
          <p class="mb-4 text-sm text-slate-600">Example: "Health Administration".</p>
          <%= form_with model: [:admin, @new_major], url: admin_majors_path, local: true, class: "space-y-4" do |form| %>
            <div class="space-y-1">
              <%= form.label :name, "Major / Program name", class: "text-sm font-medium text-slate-700" %>
              <%= form.text_field :name, required: true, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm shadow-sm" %>
            </div>
            <%= form.submit "Save major", class: tailwind_button_classes(:primary) %>
          <% end %>
        </div>
      </div>
    </section>
  <% end %>

  <% if @tab == "years" %>
    <section class="w-full c-card u-stack">
      <header class="toolbar">
        <div>
          <h2 class="text-xl font-semibold text-slate-900">Program years</h2>
          <p class="text-sm text-slate-600">View and manage year options used by student profiles and target levels.</p>
        </div>
      </header>

      <div class="grid gap-6 lg:grid-cols-[2fr_1fr]">
        <div class="u-stack u-stack--md">
          <% if @program_years.blank? %>
            <div class="rounded-xl border border-dashed border-slate-300 bg-slate-50 px-4 py-6 text-sm text-slate-600">
              No program years yet. Use the form to create your first entry.
            </div>
          <% else %>
            <ul class="space-y-3">
              <% @program_years.each do |year| %>
                <li class="rounded-xl border border-slate-200 bg-slate-50 px-4 py-3">
                  <div class="flex flex-wrap items-center justify-between gap-3">
                    <div>
                      <p class="text-base font-semibold text-slate-900">Year <%= year.value %></p>
                      <p class="text-xs text-slate-500">Position: <%= year.position %></p>
                    </div>
                    <div class="flex flex-wrap items-center gap-2">
                      <% if year.active? %>
                        <span class="inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700">Active</span>
                      <% else %>
                        <span class="inline-flex items-center rounded-full bg-slate-200 px-3 py-1 text-xs font-semibold text-slate-700">Inactive</span>
                      <% end %>
                      <details>
                        <summary class="cursor-pointer list-none <%= tailwind_button_classes(:secondary, extra_classes: 'btn-sm') %>">Edit</summary>
                        <div class="mt-3 rounded-lg border border-slate-200 bg-white p-4">
                          <%= form_with model: [:admin, year], local: true, class: "space-y-3" do |form| %>
                            <div class="grid gap-3 sm:grid-cols-2">
                              <div class="space-y-1">
                                <%= form.label :value, "Year number", class: "text-sm font-medium text-slate-700" %>
                                <%= form.number_field :value, required: true, min: 1, step: 1, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm" %>
                              </div>
                              <div class="space-y-1">
                                <%= form.label :position, "Position", class: "text-sm font-medium text-slate-700" %>
                                <%= form.number_field :position, min: 0, step: 1, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm" %>
                              </div>
                              <div class="flex items-center gap-2 pt-6 text-sm text-slate-700">
                                <%= form.check_box :active, class: "h-4 w-4 rounded border-slate-300" %>
                                <%= form.label :active, "Active", class: "text-sm font-medium text-slate-700" %>
                              </div>
                            </div>
                            <div class="flex flex-wrap gap-2">
                              <%= form.submit "Save changes", class: tailwind_button_classes(:primary, extra_classes: "btn-sm") %>
                              <%= button_to "Delete",
                                            admin_program_year_path(year),
                                            method: :delete,
                                            data: { turbo_confirm: "Delete Year #{year.value}?" },
                                            class: tailwind_button_classes(:danger, extra_classes: "btn-sm") %>
                            </div>
                          <% end %>
                        </div>
                      </details>
                    </div>
                  </div>
                </li>
              <% end %>
            </ul>
          <% end %>
        </div>

        <div class="c-card c-card--tight c-card--muted">
          <h3 class="text-base font-semibold text-slate-900">Add program year</h3>
          <p class="mb-4 text-sm text-slate-600">Example: 3</p>
          <%= form_with model: [:admin, @new_program_year], url: admin_program_years_path, local: true, class: "space-y-4" do |form| %>
            <div class="space-y-1">
              <%= form.label :value, "Year number", class: "text-sm font-medium text-slate-700" %>
              <%= form.number_field :value, required: true, min: 1, step: 1, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm shadow-sm" %>
            </div>
            <%= form.submit "Save year", class: tailwind_button_classes(:primary) %>
          <% end %>
        </div>
      </div>
    </section>
  <% end %>

  <% if @tab == "semesters" %>
    <section class="w-full c-card u-stack">
      <header class="toolbar">
        <div>
          <h2 class="text-xl font-semibold text-slate-900">Program semesters</h2>
          <p class="text-sm text-slate-600">View and manage semesters used for survey assignment windows.</p>
        </div>
        <% if @current_program_semester.present? %>
          <span class="inline-flex items-center gap-2 rounded-full bg-indigo-50 px-4 py-1 text-sm font-semibold text-indigo-700">
            <span class="h-2 w-2 rounded-full bg-indigo-500" aria-hidden="true"></span>
            Current: <%= @current_program_semester.name %>
          </span>
        <% else %>
          <span class="inline-flex items-center rounded-full bg-amber-100 px-4 py-1 text-sm font-semibold text-amber-800">No current semester set</span>
        <% end %>
      </header>

      <div class="grid gap-6 lg:grid-cols-[2fr_1fr]">
        <div class="u-stack u-stack--md">
          <% if @program_semesters.blank? %>
            <div class="rounded-xl border border-dashed border-slate-300 bg-slate-50 px-4 py-6 text-sm text-slate-600">
              No semesters yet. Use the form to create your first entry.
            </div>
          <% else %>
            <ul class="space-y-3">
              <% @program_semesters.each do |semester| %>
                <li class="rounded-xl border border-slate-200 bg-slate-50 px-4 py-3">
                  <div class="flex flex-wrap items-center justify-between gap-3">
                    <div>
                      <p class="text-base font-semibold text-slate-900"><%= semester.name %></p>
                      <p class="text-xs text-slate-500">Added <%= time_ago_in_words(semester.created_at) %> ago</p>
                    </div>
                    <div class="flex flex-wrap items-center gap-2">
                      <% if semester.current? %>
                        <span class="inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700">Current</span>
                      <% else %>
                        <%= button_to "Make current",
                                      make_current_admin_program_semester_path(semester),
                                      method: :patch,
                                      class: tailwind_button_classes(:subtle, extra_classes: "btn-sm") %>
                      <% end %>

                      <details>
                        <summary class="cursor-pointer list-none <%= tailwind_button_classes(:secondary, extra_classes: 'btn-sm') %>">Edit</summary>
                        <div class="mt-3 rounded-lg border border-slate-200 bg-white p-4">
                          <%= form_with model: [:admin, semester], local: true, class: "space-y-3" do |form| %>
                            <div class="space-y-1">
                              <%= form.label :name, "Semester name", class: "text-sm font-medium text-slate-700" %>
                              <%= form.text_field :name, required: true, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm" %>
                            </div>
                            <div class="flex flex-wrap gap-2">
                              <%= form.submit "Save changes", class: tailwind_button_classes(:primary, extra_classes: "btn-sm") %>
                              <%= button_to "Delete",
                                            admin_program_semester_path(semester),
                                            method: :delete,
                                            data: { turbo_confirm: "Delete #{semester.name}?" },
                                            class: tailwind_button_classes(:danger, extra_classes: "btn-sm") %>
                            </div>
                          <% end %>
                        </div>
                      </details>
                    </div>
                  </div>
                </li>
              <% end %>
            </ul>
          <% end %>
        </div>

        <div class="c-card c-card--tight c-card--muted">
          <h3 class="text-base font-semibold text-slate-900">Add semester</h3>
          <p class="mb-4 text-sm text-slate-600">Name semesters consistently (e.g., "Fall 2026").</p>
          <%= form_with model: [:admin, @new_program_semester], url: admin_program_semesters_path, local: true, class: "space-y-4" do |form| %>
            <div class="space-y-1">
              <%= form.label :name, "Semester name", class: "text-sm font-medium text-slate-700" %>
              <%= form.text_field :name, required: true, class: "w-full rounded-lg border border-slate-300 px-3 py-2 text-sm shadow-sm", placeholder: "Fall 2026" %>
            </div>
            <div class="flex items-start gap-2 text-sm text-slate-600">
              <%= form.check_box :current, class: "mt-1 h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500" %>
              <label for="program_semester_current" class="space-y-1">
                <span class="font-medium text-slate-700">Set as current semester</span>
                <p>Existing current semester will be turned off automatically.</p>
              </label>
            </div>
            <%= form.submit "Save semester", class: tailwind_button_classes(:primary) %>
          <% end %>
        </div>
      </div>
    </section>
  <% end %>
</main>
