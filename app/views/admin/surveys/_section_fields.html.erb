<% section = section_fields.object %>
<% form_uid = section.respond_to?(:form_uid) && section.form_uid.present? ? section.form_uid : "section-temp-#{SecureRandom.hex(4)}" %>
<% section.form_uid = form_uid if section.respond_to?(:form_uid=) %>
<article id="<%= form_uid %>"
         class="c-card survey-section-card space-y-5 text-left"
         data-builder-kind="section"
         data-builder-label="<%= section.title.to_s.strip.presence || 'Untitled section' %>"
         data-section-entry
         data-section-form-uid="<%= form_uid %>"
         data-section-new-record="<%= section.persisted? ? 'false' : 'true' %>">
  <div class="flex flex-col gap-4 md:flex-row md:items-start md:justify-between">
    <div class="flex-1 space-y-2">
      <%= section_fields.hidden_field :id %>
      <%= section_fields.hidden_field :_destroy, value: section.marked_for_destruction? ? 1 : 0 %>
      <%= section_fields.hidden_field :form_uid, value: section.form_uid %>
      <%= section_fields.hidden_field :position %>

      <div class="flex items-center justify-between gap-3">
        <span class="js-drag-handle select-none rounded-md border border-slate-200 bg-white px-2 py-1 text-xs font-semibold text-slate-500 cursor-grab" aria-label="Drag to reorder">
          â‹®â‹®
        </span>
        <span class="text-xs font-semibold uppercase tracking-wide text-amber-700">Section</span>
      </div>

      <%= section_fields.label :title, "Section title", class: "block text-sm font-medium text-slate-700" %>
      <%= section_fields.text_field :title,
            class: input_classes,
            placeholder: "Student Experience" %>
    </div>

    <button type="button"
            class="<%= tailwind_button_classes(:secondary, extra_classes: 'btn-sm') %> text-rose-600"
            data-action="section-fields#remove">
      <span aria-hidden="true">ğŸ—‘ï¸</span>
      <span>Remove</span>
    </button>
  </div>

  <div class="space-y-2">
    <%= section_fields.label :description, "Description (optional)", class: "block text-sm font-medium text-slate-700" %>
    <%= section_fields.text_area :description,
                                 class: textarea_classes,
                                 placeholder: "Brief instructions shown before the grouped categories." %>
  </div>

  <div class="mt-6 space-y-6" data-category-group data-section-uid="<%= form_uid %>" data-category-group-list>
    <% if local_assigns[:categories_html].present? %>
      <%= local_assigns[:categories_html] %>
    <% end %>
  </div>

</article>
