<!-- app/views/advisors/students/index.html.erb -->
<main class="main-content">
  <section class="dashboard-section">
    <div class="section-header">
      <h1 class="section-title">My Students</h1>
      <p class="section-subtitle">Students youâ€™re currently working with</p>
    </div>

    <% if @students.present? %>
      <div class="dashboard-grid dashboard-grid-1">
        <% @students.each do |s| %>
          <div class="feature-item" style="margin-bottom:2em;">
            <div class="feature-icon" aria-hidden="true">ðŸŽ“</div>
            <div class="feature-title">
              <%= s.name || s.email %>
            </div>
            <div class="feature-description">
              <%= s.email %>
            </div>
            <% if s.survey_responses.any? %>
              <div class="student-surveys" style="margin-top:1em;">
                <strong>Survey Responses:</strong>
                <ul>
                  <% s.survey_responses.each do |sr| %>
                    <li>
                      <strong>Survey:</strong> <%= sr.survey&.title || 'N/A' %><br>
                      <strong>Status:</strong> <%= sr.status %><br>
                      <% if sr.respond_to?(:answers) && sr.answers.present? %>
                        <strong>Answers:</strong>
                        <ul>
                          <% sr.answers.each do |q, a| %>
                            <li><%= q %>: <%= a %></li>
                          <% end %>
                        </ul>
                      <% end %>
                    </li>
                  <% end %>
                </ul>
              </div>
            <% else %>
              <div class="student-surveys" style="margin-top:1em; color:#888;">No survey responses.</div>
            <% end %>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="feature-item" style="max-width: 560px; margin: 0 auto;">
        <div class="feature-icon" aria-hidden="true">ðŸ“­</div>
        <div class="feature-title">No students assigned</div>
        <div class="feature-description">Once youâ€™re assigned students, theyâ€™ll appear here.</div>
      </div>
    <% end %>
  </section>
</main>
