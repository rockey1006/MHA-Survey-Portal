<!-- Main Content for Admin Dashboard - layout provides html/head/body and navbar -->
<main class="main-content main-content--dashboard">
  <%= render "shared/role_switcher" %>

  <section class="c-card dashboard-section">
    <div class="section-header">
      <h1 class="section-title">Admin Dashboard</h1>
      <p class="section-subtitle">System management for the MHA Program</p>
    </div>
    
    <div class="dashboard-grid dashboard-grid-4">
      <!-- Surveys -->
      <div class="c-card c-card--interactive c-card--lift c-tile">
        <%= link_to admin_surveys_path, class: "c-tile__link" do %>
          <div class="c-tile__icon">ğŸ“„</div>
          <div class="c-tile__title">Surveys</div>
          <div class="c-tile__description"><%= @total_surveys || 0 %> active</div>
        <% end %>
      </div>

      <!-- Target Levels -->
      <div class="c-card c-card--interactive c-card--lift c-tile">
        <%= link_to admin_target_levels_path, class: "c-tile__link" do %>
          <div class="c-tile__icon">ğŸ¯</div>
          <div class="c-tile__title">Target Levels</div>
          <div class="c-tile__description">Configure competency targets</div>
        <% end %>
      </div>

      <!-- Program Setup -->
      <div class="c-card c-card--interactive c-card--lift c-tile">
        <%= link_to admin_program_setup_path, class: "c-tile__link" do %>
          <div class="c-tile__icon">ğŸ§©</div>
          <div class="c-tile__title">Program Setup</div>
          <div class="c-tile__description">Tracks, majors, years, semesters</div>
        <% end %>
      </div>

      <!-- Reports -->
      <div class="c-card c-card--interactive c-card--lift c-tile">
        <%= link_to reports_path, class: "c-tile__link" do %>
          <div class="c-tile__icon">ğŸ“Š</div>
          <div class="c-tile__title">Reports</div>
          <div class="c-tile__description"><%= @total_reports || 0 %> generated</div>
        <% end %>
      </div>

      <!-- Students Records -->
      <div class="c-card c-card--interactive c-card--lift c-tile">
        <%= link_to student_records_path, class: "c-tile__link" do %>
          <div class="c-tile__icon">ğŸ‘¨â€ğŸ“</div>
          <div class="c-tile__title">Students Records</div>
          <div class="c-tile__description"><%= @role_counts[:student] || 0 %> registered</div>
        <% end %>
      </div>

      <!-- Manage Students -->
      <div class="c-card c-card--interactive c-card--lift c-tile">
        <%= link_to manage_students_path, class: "c-tile__link" do %>
          <div class="c-tile__icon">âš™ï¸</div>
          <div class="c-tile__title">Manage Students</div>
          <div class="c-tile__description"><%= pluralize(@advisee_count, "assigned student") %></div>
        <% end %>
      </div>

      <!-- Members -->
      <div class="c-card c-card--interactive c-card--lift c-tile">
        <%= link_to manage_members_path, class: "c-tile__link" do %>
          <div class="c-tile__icon">ğŸ§‘â€ğŸ’¼</div>
          <div class="c-tile__title">Member Management</div>
          <div class="c-tile__description"><%= @role_counts[:advisor] || 0 %> advisors</div>
        <% end %>
      </div>

      <!-- View as Student/Advisor -->
      <div class="c-card c-card--interactive c-card--lift c-tile">
        <%= link_to new_impersonation_path, class: "c-tile__link" do %>
          <div class="c-tile__icon c-tile__icon--warning">ğŸ•µï¸</div>
          <div class="c-tile__title c-tile__title--warning">View as Student/Advisor</div>
          <div class="c-tile__description">Read-only preview</div>
        <% end %>
      </div>

      <!-- Maintenance Mode -->
      <div class="c-card c-card--interactive c-card--lift c-tile">
        <%= link_to admin_maintenance_path, class: "c-tile__link" do %>
          <div class="c-tile__icon c-tile__icon--warning">ğŸ› ï¸</div>
          <div class="c-tile__title c-tile__title--warning">Maintenance Mode</div>
          <div class="c-tile__description"><%= @maintenance_enabled ? "Enabled" : "Disabled" %></div>
        <% end %>
      </div>
    </div>
  </section>

  <section class="c-card dashboard-section md:px-12" style="margin-top: var(--spacing-4xl);">
    <div class="section-header">
      <h2 class="section-title">Recent Activity</h2>
      <p class="section-subtitle">Latest updates across surveys, feedback, and assignments</p>
    </div>

    <% if @recent_activity.present? %>
      <div class="space-y-3">
        <% @recent_activity.each do |entry| %>
          <div class="flex items-start gap-4 rounded-xl border border-slate-200 bg-white p-4 shadow-sm">
            <div class="flex h-12 w-12 items-center justify-center rounded-full bg-slate-100 text-2xl"><%= entry[:icon] || "ğŸ“Œ" %></div>
            <div class="flex-1 space-y-1">
              <div class="font-semibold text-slate-900">
                <% if entry[:url].present? %>
                  <%= link_to entry[:title], entry[:url], class: "text-[#500000] hover:underline" %>
                <% else %>
                  <%= entry[:title] %>
                <% end %>
              </div>
              <% if entry[:subtitle].present? %>
                <div class="text-sm text-slate-600"><%= entry[:subtitle] %></div>
              <% end %>
            </div>
            <div class="text-xs text-slate-500 whitespace-nowrap">
              <% if entry[:timestamp].present? %>
                <span title="<%= l(entry[:timestamp], format: :long) %>"><%= time_ago_in_words(entry[:timestamp]) %> ago</span>
              <% else %>
                <span>n/a</span>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="flex flex-col items-center justify-center gap-3 rounded-2xl border border-dashed border-slate-300 bg-white p-10 text-center shadow-sm">
        <span class="text-4xl" aria-hidden="true">âœ¨</span>
        <p class="text-sm text-slate-600">No recent activity logged yet.</p>
      </div>
    <% end %>
  </section>
</main>